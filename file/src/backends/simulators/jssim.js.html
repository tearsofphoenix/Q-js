<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">src/backends/simulators/jssim.js | projectq</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#backends">backends</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/printer.js~CommandPrinter.html">CommandPrinter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/resource.js~ResourceCounter.html">ResourceCounter</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#backends-circuits">backends/circuits</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/circuits/drawer.js~CircuitDrawer.html">CircuitDrawer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/circuits/drawer.js~CircuitItem.html">CircuitItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/circuits/tolatex.js~_Circ2Tikz.html">_Circ2Tikz</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#backends-ibm">backends/ibm</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/ibm/ibm.js~IBMBackend.html">IBMBackend</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/ibm/ibmhttpclient.js~IBMHTTPClient.html">IBMHTTPClient</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#backends-simulators">backends/simulators</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/simulators/classicalsimulator.js~ClassicalSimulator.html">ClassicalSimulator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/simulators/jssim.js~Simulator.html">Simulator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/simulators/shared.spec.js~TrivialMapper.html">TrivialMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/simulators/simulator.js~Simulator.html">Simulator</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#cengines">cengines</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/basicmapper.js~BasicMapperEngine.html">BasicMapperEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/basics.js~BasicEngine.html">BasicEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/basics.js~ForwarderEngine.html">ForwarderEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/cmdmodifier.js~CommandModifier.html">CommandModifier</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/ibm5qubitmapper.js~IBM5QubitMapper.html">IBM5QubitMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/linearmapper.js~LinearMapper.html">LinearMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/main.js~MainEngine.html">MainEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/manualmapper.js~ManualMapper.html">ManualMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/optimize.js~LocalOptimizer.html">LocalOptimizer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/swapandcnotflipper.js~SwapAndCNOTFlipper.html">SwapAndCNOTFlipper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/tagremover.js~TagRemover.html">TagRemover</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/testengine.js~CompareEngine.html">CompareEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/testengine.js~DummyEngine.html">DummyEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/twodmapper.js~GridMapper.html">GridMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/twodmapper.js~Position.html">Position</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ibmqx4_connections">ibmqx4_connections</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#cengines-replacer">cengines/replacer</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/replacer/decompositionrule.js~DecompositionRule.html">DecompositionRule</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/replacer/decompositionruleset.js~DecompositionRuleSet.html">DecompositionRuleSet</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/replacer/replacer.js~AutoReplacer.html">AutoReplacer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/replacer/replacer.js~InstructionFilter.html">InstructionFilter</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#libs">libs</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-len">len</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-classHierachy">classHierachy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-instanceOf">instanceOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isKindclassOf">isKindclassOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isSubclassOf">isSubclassOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-tuple">tuple</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#libs-math">libs/math</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/libs/math/gates.js~AddConstant.html">AddConstant</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/libs/math/gates.js~AddConstantModN.html">AddConstantModN</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/libs/math/gates.js~MultiplyByConstantModN.html">MultiplyByConstantModN</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SubConstant">SubConstant</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SubConstantModN">SubConstantModN</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#meta">meta</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/compute.js~ComputeEngine.html">ComputeEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/compute.js~UncomputeEngine.html">UncomputeEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/control.js~ControlEngine.html">ControlEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/dagger.js~DaggerEngine.html">DaggerEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~LastEngineError.html">LastEngineError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~NoGateDecompositionError.html">NoGateDecompositionError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~NotMergeable.html">NotMergeable</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~NotYetMeasuredError.html">NotYetMeasuredError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~QubitManagementError.html">QubitManagementError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/loop.js~LoopEngine.html">LoopEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/loop.js~LoopTag.html">LoopTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/tag.js~ComputeTag.html">ComputeTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/tag.js~DirtyQubitTag.html">DirtyQubitTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/tag.js~LogicalQubitIDTag.html">LogicalQubitIDTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/tag.js~UncomputeTag.html">UncomputeTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Compute">Compute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CustomUncompute">CustomUncompute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Uncompute">Uncompute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Control">Control</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Dagger">Dagger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Loop">Loop</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dropEngineAfter">dropEngineAfter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-insertEngine">insertEngine</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ops">ops</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~BasicGate.html">BasicGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~BasicMathGate.html">BasicMathGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~BasicPhaseGate.html">BasicPhaseGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~BasicRotationGate.html">BasicRotationGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~ClassicalInstructionGate.html">ClassicalInstructionGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~FastForwardingGate.html">FastForwardingGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~SelfInverseGate.html">SelfInverseGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/command.js~Command.html">Command</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~AllocateDirtyQubitGate.html">AllocateDirtyQubitGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~AllocateQubitGate.html">AllocateQubitGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~BarrierGate.html">BarrierGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~DeallocateQubitGate.html">DeallocateQubitGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~EntangleGate.html">EntangleGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~FlushGate.html">FlushGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~HGate.html">HGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~MeasureGate.html">MeasureGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~Ph.html">Ph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~R.html">R</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~Rx.html">Rx</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~Ry.html">Ry</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~Rz.html">Rz</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~SGate.html">SGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~SqrtSwapGate.html">SqrtSwapGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~SqrtXGate.html">SqrtXGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~SwapGate.html">SwapGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~TGate.html">TGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~XGate.html">XGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~YGate.html">YGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~ZGate.html">ZGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/metagates.js~ControlledGate.html">ControlledGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/metagates.js~DaggeredGate.html">DaggeredGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/metagates.js~Tensor.html">Tensor</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/qftgate.js~QFTGate.html">QFTGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/qubitoperator.js~QubitOperator.html">QubitOperator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/timeevolution.js~TimeEvolution.html">TimeEvolution</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getInverse">getInverse</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-C">C</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-stringToArray">stringToArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CRz">CRz</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Allocate">Allocate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AllocateDirty">AllocateDirty</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Entangle">Entangle</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-H">H</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Measure">Measure</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-NOT">NOT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-S">S</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SqrtSwap">SqrtSwap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SqrtX">SqrtX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Swap">Swap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-T">T</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-X">X</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Y">Y</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Z">Z</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-All">All</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-QFT">QFT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CNOT">CNOT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CX">CX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CZ">CZ</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Toffoli">Toffoli</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#setups">setups</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ibmqx5_connections">ibmqx5_connections</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#types">types</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/types/qubit.js~BasicQubit.html">BasicQubit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/types/qubit.js~Qubit.html">Qubit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Qureg">Qureg</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/backends/simulators/jssim.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/*
 * Copyright (c) 2018 Isaac Phoenix (tearsofphoenix@icloud.com).
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*
Contains a (slow) JavaScript simulator.

    Please compile the c++ simulator for large-scale simulations.
*/
import assert from &apos;assert&apos;
import math from &apos;mathjs&apos;
import {
  matrixDot,
  matrixRangeAssign,
  matrixRangeIndicesAssign,
  zeros
} from &apos;../../libs/util&apos;
import {
  len, setEqual, complexVectorDot
} from &apos;../../libs/polyfill&apos;
import { stringToArray } from &apos;../../ops/qubitoperator&apos;

/**
 * @class JSSimulator
 * @desc
NodeJS implementation of a quantum computer simulator.

    This Simulator can be used as a backup if compiling the c++ simulator is
not an option (for some reason). It has the same features but is much
slower, so please consider building the c++ version for larger experiments.
 */
export default class Simulator {
  /**
   * @constructor
   */
  constructor() {
    // ignore seed
    this._state = math.ones(1)
    this._map = {}
    this._numQubits = 0
  }

  /**
  Return the qubit index to bit location map and the corresponding state
vector.

    This function can be used to measure expectation values more efficiently (emulation).

    @return {Array}
A tuple where the first entry is a dictionary mapping qubit indices
to bit-locations and the second entry is the corresponding state
vector
   */
  cheat() {
    return [this._map, this._state._data.slice(0)]
  }

  /**
  Measure the qubits with IDs ids and return a list of measurement
outcomes (true/false).

    @param {number[]} ids List of qubit IDs to measure.

    @return {boolean[]} List of measurement results (containing either true or false).
   */
  measureQubits(ids) {
    const P = Math.random()
    let val = 0.0
    let i_picked = 0
    while (val &lt; P &amp;&amp; i_picked &lt; len(this._state)) {
      val = math.add(val, math.abs(this._getState(i_picked) || math.complex(0, 0)) ** 2)
      i_picked += 1
    }

    i_picked -= 1

    const res = []
    const pos = ids.map((ID) =&gt; {
      res.push(false)
      return this._map[ID]
    })

    let mask = 0
    val = 0

    pos.forEach((looper, i) =&gt; {
      res[i] = ((i_picked &gt;&gt; looper) &amp; 1) === 1
      mask |= (1 &lt;&lt; looper)
      val |= ((res[i] &amp; 1) &lt;&lt; looper)
    })

    let nrm = 0.0
    this._state.forEach((looper, _i) =&gt; {
      const i = _i[0]
      if ((mask &amp; i) !== val) {
        this._setState(i, 0.0)
      } else {
        const tmp = math.abs(looper)
        nrm = math.add(nrm, math.multiply(tmp, tmp))
      }
    })
    // normalize
    const scale = 1.0 / Math.sqrt(nrm)
    this._state = math.multiply(this._state, scale)
    return res
  }

  /**
  Allocate a qubit.

    @param {number} ID ID of the qubit which is being allocated.
   */
  allocateQubit(ID) {
    this._map[ID] = this._numQubits
    this._numQubits += 1
    this._state.resize([1 &lt;&lt; this._numQubits], 0)
  }

  /**
  Return the classical value of a classical bit (i.e., a qubit which has
been measured / uncomputed).

   @param {number} ID ID of the qubit of which to get the classical value.
   @param {number} tolerance Tolerance for numerical errors when determining
whether the qubit is indeed classical.

    @throws {Error} If the qubit is in a superposition, i.e., has not been measured / uncomputed.
*/
  getClassicalValue(ID, tolerance = 1.e-10) {
    const pos = this._map[ID]
    let up = false
    let down = false

    for (let i = 0; i &lt; len(this._state); i += (1 &lt;&lt; (pos + 1))) {
      for (let j = 0; j &lt; (1 &lt;&lt; pos); ++j) {
        if (math.abs(this._getState(i + j)) &gt; tolerance) {
          up = true
        }

        if (math.abs(this._getState(i + j + (1 &lt;&lt; pos)) || 0) &gt; tolerance) {
          down = true
        }

        if (up &amp;&amp; down) {
          throw new Error(&apos;Qubit has not been measured / &apos;
          + &apos;uncomputed. Cannot access its &apos;
          + &apos;classical value and/or deallocate a &apos;
          + &apos;qubit in superposition!&apos;)
        }
      }
    }

    return down
  }

  /**
  Deallocate a qubit (if it has been measured / uncomputed).

   @param {number} ID ID of the qubit to deallocate.

   @throws {Error} If the qubit is in a superposition, i.e., has not been measured / uncomputed.
   */
  deallocateQubit(ID) {
    const pos = this._map[ID]
    const cv = this.getClassicalValue(ID)
    const newstate = math.zeros(1 &lt;&lt; (this._numQubits - 1))
    let k = 0
    for (let i = (1 &lt;&lt; pos) * cv; i &lt; len(this._state); i += 1 &lt;&lt; (pos + 1)) {
      matrixRangeIndicesAssign(newstate, k, k + (1 &lt;&lt; pos), this._state, i)
      k += (1 &lt;&lt; pos)
    }

    const newmap = {}
    Object.keys(this._map).forEach((key) =&gt; {
      const value = this._map[key]
      if (value &gt; pos) {
        newmap[key] = value - 1
      } else if (parseInt(key, 10) !== ID) {
        newmap[key] = value
      }
    })

    this._map = newmap
    this._state = newstate
    this._numQubits -= 1
  }

  /**
  Get control mask from list of control qubit IDs.

    @return {number} A mask which represents the control qubits in binary.
   */
  getControlMask(ctrlids) {
    let mask = 0
    ctrlids.forEach((ctrlid) =&gt; {
      const ctrlpos = this._map[ctrlid]
      mask |= (1 &lt;&lt; ctrlpos)
    })
    return mask
  }

  /**
  Emulate a math function (e.g., BasicMathGate).

    @param {function} f Function executing the operation to emulate.
    @param {Array.&lt;number[]&gt;} qubitIDs List of lists of qubit IDs to which
        the gate is being applied. Every gate is applied to a tuple of
        quantum registers, which corresponds to this &apos;list of lists&apos;.
    @param {number[]} ctrlQubitIDs List of control qubit ids.
   */
  emulateMath(f, qubitIDs, ctrlQubitIDs) {
    const mask = this.getControlMask(ctrlQubitIDs)
    // determine qubit locations from their IDs
    const qb_locs = []
    qubitIDs.forEach((qureg) =&gt; {
      qb_locs.push([])
      qureg.forEach((qubitID) =&gt; {
        qb_locs[qb_locs.length - 1].push(this._map[qubitID])
      })
    })

    const newstate = math.zeros(len(this._state))

    this._state.forEach((looper, _i) =&gt; {
      const i = _i[0]
      if ((mask &amp; i) === mask) {
        const argList = zeros(qb_locs.length)
        qb_locs.forEach((qb, qri) =&gt; {
          qb.forEach((il, qi) =&gt; {
            argList[qri] |= (((i &gt;&gt; il) &amp; 1) &lt;&lt; qi)
          })
        })

        const res = f(argList)
        let newI = i

        qb_locs.forEach((qb, qri) =&gt; {
          qb.forEach((il, qi) =&gt; {
            if (!(((newI &gt;&gt; il) &amp; 1) == ((res[qri] &gt;&gt; qi) &amp; 1))) {
              newI ^= (1 &lt;&lt; il)
            }
          })
        })
        newstate.subset(math.index(newI), looper)
      } else {
        newstate.subset(math.index(i), looper)
      }
    })

    this._state = newstate
  }

  /**
  Return the expectation value of a qubit operator w.r.t. qubit ids.

    @param {Array.&lt;Array&gt;} termsArray Operator Array (see QubitOperator.terms)
    @param {number[]} IDs List of qubit ids upon which the operator acts.

    @return Expectation value
   */
  getExpectationValue(termsArray, IDs) {
    let expectation = 0.0
    const current_state = math.clone(this._state)
    termsArray.forEach(([term, coefficient]) =&gt; {
      this.applyTerm(term, IDs)
      const tmp = complexVectorDot(current_state, this._state)
      const delta = math.multiply(coefficient, tmp)
      expectation = math.add(expectation, delta)
      this._state = math.clone(current_state)
    })
    if (math.im(expectation) === 0) {
      return math.re(expectation)
    }
    return expectation
  }

  /**
  Apply a (possibly non-unitary) qubit operator to qubits.

    @param {Array.&lt;Array&gt;} termsArray Operator array (see QubitOperator.terms)
    @param {number[]} IDs List of qubit ids upon which the operator acts.
  */
  applyQubitOperator(termsArray, IDs) {
    let new_state = math.zeros(len(this._state))
    const current_state = math.clone(this._state)
    termsArray.forEach(([term, coefficient]) =&gt; {
      this.applyTerm(term, IDs)
      const temp = math.multiply(this._state, coefficient)
      new_state = math.add(new_state, temp)
      this._state = math.clone(current_state)
    })
    this._state = new_state
  }

  /**
  Return the probability of the outcome `bit_string` when measuring
the qubits given by the list of ids.

    @param {boolean[]|number[]} bitString Measurement outcome.
    @param {number[]} IDs List of qubit ids determining the ordering.

    @return Probability of measuring the provided bit string.

    @throws {Error} if an unknown qubit id was provided.
   */
  getProbability(bitString, IDs) {
    const n = IDs.length
    for (let i = 0; i &lt; n; ++i) {
      const id = IDs[i]
      const v = this._map[id]
      if (typeof v === &apos;undefined&apos;) {
        throw new Error(&apos;get_probability(): Unknown qubit id. &apos;
        + &apos;Please make sure you have called &apos;
        + &apos;eng.flush().&apos;)
      }
    }
    let mask = 0
    let bit_str = 0
    for (let i = 0; i &lt; n; ++i) {
      mask |= (1 &lt;&lt; this._map[IDs[i]])
      bit_str |= (bitString[i] &lt;&lt; this._map[IDs[i]])
    }

    let probability = 0.0

    this._state.forEach((val, _i) =&gt; {
      const i = _i[0]
      if ((i &amp; mask) === bit_str) {
        const e = val
        probability += math.re(e) ** 2 + math.im(e) ** 2
      }
    })
    return probability
  }

  _getState(i) {
    return this._state.subset(math.index(i))
  }

  _setState(i, value) {
    this._state.subset(math.index(i), value)
  }

  /**
  Return the probability amplitude of the supplied `bit_string`.
    The ordering is given by the list of qubit ids.

   @param {boolean[]|number[]} bitString Computational basis state
   @param {number[]} IDs List of qubit ids determining the ordering. Must contain all allocated qubits.

    @return Probability amplitude of the provided bit string.

    @throws {Error} if the second argument is not a permutation of all allocated qubits.
   */
  getAmplitude(bitString, IDs) {
    const s1 = new Set(IDs)
    const s2 = new Set(Object.keys(this._map).map(k =&gt; parseInt(k, 10)))
    if (!setEqual(s1, s2)) {
      throw new Error(&apos;The second argument to get_amplitude() must&apos;
      + &apos; be a permutation of all allocated qubits. &apos;
      + &apos;Please make sure you have called &apos;
      + &apos;eng.flush().&apos;)
    }
    let index = 0
    IDs.forEach((item, i) =&gt; {
      item = parseInt(item, 10)
      index |= (bitString[i] &lt;&lt; this._map[item])
    })
    const ret = this._getState(index)
    return ret
  }

  /**
Applies exp(-i*time*H) to the wave function, i.e., evolves under
the Hamiltonian H for a given time. The terms in the Hamiltonian
are not required to commute.

    This function computes the action of the matrix exponential using
ideas from Al-Mohy and Higham, 2011.
TODO: Implement better estimates for s.

   @param {Array.&lt;Array&gt;} terms_dict Operator dictionary (see QubitOperator.terms) defining the Hamiltonian.
   @param {number} time Time to evolve for
   @param {number[]} ids A list of qubit IDs to which to apply the evolution.
   @param {number[]} ctrlids A list of control qubit IDs.
  */
  emulateTimeEvolution(terms_dict, time, ids, ctrlids) {
    // Determine the (normalized) trace, which is nonzero only for identity
  // terms:
    let tr = 0
    let sum = 0
    const newTerms = []
    terms_dict.forEach(([t, c]) =&gt; {
      if (t.length === 0) {
        tr += c
      } else {
        newTerms.push([t, c])
        sum += Math.abs(c)
      }
    })

    terms_dict = newTerms
    const op_nrm = math.abs(time) * sum
    // rescale the operator by s:
    const s = Math.floor(op_nrm + 1)
    const correction = math.exp(math.complex(0, -time * tr / (s * 1.0)))
    const output_state = math.clone(this._state)
    const mask = this.getControlMask(ctrlids)

    for (let i = 0; i &lt; s; ++i) {
      let j = 0
      let nrm_change = 1.0
      let update
      while (nrm_change &gt; 1.e-12) {
        const coeff = math.divide(math.complex(0, -time), s * (j + 1))
        const current_state = math.clone(this._state)
        update = 0
        terms_dict.forEach(([t, c]) =&gt; {
          this.applyTerm(t, ids)
          this._state = math.multiply(this._state, c)

          update = math.add(this._state, update)
          // update += this._state
          this._state = math.clone(current_state)
        })
        update = math.multiply(update, coeff)
        this._state = update
        for (let i = 0; i &lt; update.length; ++i) {
          if ((i &amp; mask) === mask) {
            output_state[i] = math.add(output_state[i], update[i])
          }
        }
        nrm_change = math.norm(update)
        j += 1
      }
      for (let i = 0; i &lt; update.length; ++i) {
        if ((i &amp; mask) === mask) {
          output_state[i] *= correction
        }
      }
      this._state = math.clone(output_state)
    }
  }

  /**
   * leave it empty to keep same API with cpp simulator
   */
  run() {
    //
  }

  /**
  Applies a QubitOperator term to the state vector. (Helper function for time evolution &amp; expectation)

    @param {Array} term One term of QubitOperator.terms
    @param {number[]} ids Term index to Qubit ID mapping
    @param {number[]} controlIDs Control qubit IDs
  */
  applyTerm(term, ids, controlIDs = []) {
    const X = [[0.0, 1.0], [1.0, 0.0]]
    const Y = [[0.0, math.complex(0, -1)], [math.complex(0, 1), 0.0]]
    const Z = [[1.0, 0.0], [0.0, -1.0]]
    const gates = {X, Y, Z}
    term.forEach((local_op) =&gt; {
      const qb_id = ids[local_op[0]]
      this.applyControlledGate(gates[local_op[1]], [qb_id], controlIDs)
    })
  }

  /**
  Applies the k-qubit gate matrix m to the qubits with indices ids,
    using ctrlids as control qubits.

    @param {Array.&lt;Array.&lt;number&gt;&gt;} m 2^k x 2^k complex matrix describing the k-qubit gate.
    @param {number[]} ids A list containing the qubit IDs to which to apply the gate.
    @param {number[]} ctrlids A list of control qubit IDs (i.e., the gate is only applied where these qubits are 1).
   */
  applyControlledGate(m, ids, ctrlids) {
    const mask = this.getControlMask(ctrlids)
    if (len(m) === 2) {
      const k = ids[0]
      const pos = this._map[k] || this._map[k.toString()]
      this._singleQubitGate(m, pos, mask)
    } else {
      const pos = ids.map(ID =&gt; this._map[ID])
      this._multiQubitGate(m, pos, mask)
    }
  }

  /**
  Applies the single qubit gate matrix m to the qubit at position `pos`
using `mask` to identify control qubits.

   @param {Array.&lt;Array.&lt;number&gt;&gt;} m 2x2 complex matrix describing the single-qubit gate.
    @param {number} pos Bit-position of the qubit.
    @param {number} mask Bit-mask where set bits indicate control qubits.
   */
  _singleQubitGate(m, pos, mask) {
    const kernel = (u, d, m) =&gt; {
      const ma = math.add
      const mm = math.multiply
      d = d || math.complex(0, 0)
      u = u || math.complex(0, 0)
      const r1 = ma(mm(u, m[0][0]), mm(d, m[0][1]))
      const r2 = ma(mm(u, m[1][0]), mm(d, m[1][1]))
      return [r1, r2]
    }

    const step = 1 &lt;&lt; (pos + 1)
    for (let i = 0; i &lt; len(this._state); i += step) {
      for (let j = 0; j &lt; (1 &lt;&lt; pos); ++j) {
        if (((i + j) &amp; mask) === mask) {
          const id1 = i + j
          const id2 = id1 + (1 &lt;&lt; pos)
          const [r1, r2] = kernel(this._getState(id1), this._getState(id2), m)
          this._setState(id1, r1)
          this._setState(id2, r2)
        }
      }
    }
  }

  /**
  Applies the k-qubit gate matrix m to the qubits at `pos`
using `mask` to identify control qubits.

   @param {Array.&lt;number[]&gt;} m 2^k x 2^k complex matrix describing the k-qubit gate.
   @param {number[]} pos List of bit-positions of the qubits.
   @param {number} mask Bit-mask where set bits indicate control qubits.
   see follows the description in https://arxiv.org/abs/1704.01127
   */
  _multiQubitGate(m, pos, mask) {
    const inactive = Object.keys(this._map).map(k =&gt; parseInt(k, 10)).filter(p =&gt; !pos.includes(p))

    const matrix = math.matrix(m)
    const subvec = zeros(1 &lt;&lt; pos.length)
    const subvec_idx = zeros(subvec.length)
    for (let c = 0; c &lt; (1 &lt;&lt; inactive.length); ++c) {
      // determine base index (state of inactive qubits)
      let base = 0
      for (let i = 0; i &lt; inactive.length; ++i) {
        base |= ((c &gt;&gt; i) &amp; 1) &lt;&lt; inactive[i]
      }

      // check the control mask
      if (mask !== (base &amp; mask)) {
        continue
      }
      // now gather all elements involved in mat-vec mul
      for (let x = 0; x &lt; subvec_idx.length; ++x) {
        let offset = 0
        for (let i = 0; i &lt; pos.length; ++i) {
          offset |= ((x &gt;&gt; i) &amp; 1) &lt;&lt; pos[i]
        }
        subvec_idx[x] = base | offset
        subvec[x] = this._getState(subvec_idx[x]) || math.complex(0, 0)
      }

      // perform mat-vec mul
      matrixRangeAssign(this._state, subvec_idx, matrixDot(matrix, subvec))
    }
  }

  /**
  Set wavefunction and qubit ordering.

    @param {Complex[]} wavefunction Array of complex amplitudes describing the wavefunction (must be normalized).
    @param {Array} ordering List of ids describing the new ordering of qubits
(i.e., the ordering of the provided wavefunction).
   */
  setWavefunction(wavefunction, ordering) {
    // wavefunction contains 2^n values for n qubits
    assert(wavefunction.length === (1 &lt;&lt; ordering.length))

    // all qubits must have been allocated before
    const f1 = ordering.filter((Id) =&gt; {
      const v = this._map[Id]
      return typeof v !== &apos;undefined&apos;
    }).length === ordering.length
    const f2 = len(this._map) === ordering.length
    if (!f1 || !f2) {
      throw new Error(&apos;set_wavefunction(): Invalid mapping provided.&apos;
      + &apos; Please make sure all qubits have been &apos;
      + &apos;allocated previously (call eng.flush()).&apos;)
    }

    this._state = math.matrix(wavefunction)
    const map = {}
    for (let i = 0; i &lt; ordering.length; ++i) {
      map[ordering[i]] = i
    }
    this._map = map
  }

  /**
  Collapse a quantum register onto a classical basis state.

    @param {number[]} ids Qubit IDs to collapse.
    @param {boolean[]} values Measurement outcome for each of the qubit IDs in `ids`.
    @throws {Error} If probability of outcome is ~0 or unknown qubits are provided.
   */
  collapseWavefunction(ids, values) {
    assert(ids.length === values.length)

    // all qubits must have been allocated before
    const f1 = ids.filter(Id =&gt; typeof this._map[Id] !== &apos;undefined&apos;).length === ids.length
    if (!f1) {
      throw new Error(&apos;collapse_wavefunction(): Unknown qubit id(s)&apos;
        + &apos; provided. Try calling eng.flush() before &apos;
        + &apos;invoking this function.&apos;)
    }

    let mask = 0
    let val = 0
    ids.forEach((looper, i) =&gt; {
      const pos = this._map[looper]
      mask |= (1 &lt;&lt; pos)
      val |= (Math.floor(values[i]) &lt;&lt; pos)
    })

    let nrm = 0.0
    this._state.forEach((looper, _i) =&gt; {
      const i = _i[0]
      if ((mask &amp; i) === val) {
        nrm += math.abs(this._getState(i)) ** 2
      }
    })

    if (nrm &lt; 1.e-12) {
      throw new Error(&apos;collapse_wavefunction(): Invalid collapse! Probability is ~0.&apos;)
    }
    const inv_nrm = 1.0 / math.sqrt(nrm)
    this._state.forEach((looper, _i) =&gt; {
      const i = _i[0]
      if ((mask &amp; i) !== val) {
        this._setState(i, 0)
      } else {
        this._setState(i, math.multiply(looper, inv_nrm))
      }
    })
  }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
