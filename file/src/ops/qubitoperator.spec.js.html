<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/ops/qubitoperator.spec.js | projectq</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#backends">backends</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/printer.js~CommandPrinter.html">CommandPrinter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/resource.js~ResourceCounter.html">ResourceCounter</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#backends-circuits">backends/circuits</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/circuits/drawer.js~CircuitDrawer.html">CircuitDrawer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/circuits/drawer.js~CircuitItem.html">CircuitItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/circuits/tolatex.js~_Circ2Tikz.html">_Circ2Tikz</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-_exports">_exports</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#backends-ibm">backends/ibm</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/ibm/ibm.js~IBMBackend.html">IBMBackend</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/ibm/ibmhttpclient.js~IBMHTTPClient.html">IBMHTTPClient</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#backends-simulators">backends/simulators</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/simulators/classicalsimulator.js~ClassicalSimulator.html">ClassicalSimulator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/simulators/jssim.js~Simulator.html">Simulator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/simulators/shared.spec.js~TrivialMapper.html">TrivialMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/backends/simulators/simulator.js~Simulator.html">Simulator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-All">All</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#cengines">cengines</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/basicmapper.js~BasicMapperEngine.html">BasicMapperEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/basics.js~BasicEngine.html">BasicEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/basics.js~ForwarderEngine.html">ForwarderEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/cmdmodifier.js~CommandModifier.html">CommandModifier</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/ibm5qubitmapper.js~IBM5QubitMapper.html">IBM5QubitMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/linearmapper.js~LinearMapper.html">LinearMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/main.js~MainEngine.html">MainEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/manualmapper.js~ManualMapper.html">ManualMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/optimize.js~LocalOptimizer.html">LocalOptimizer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/swapandcnotflipper.js~SwapAndCNOTFlipper.html">SwapAndCNOTFlipper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/tagremover.js~TagRemover.html">TagRemover</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/testengine.js~CompareEngine.html">CompareEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/testengine.js~DummyEngine.html">DummyEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/twodmapper.js~GridMapper.html">GridMapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-return_swap_depth">return_swap_depth</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ibmqx4_connections">ibmqx4_connections</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#cengines-replacer">cengines/replacer</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/replacer/decompositionrule.js~DecompositionRule.html">DecompositionRule</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/replacer/decompositionruleset.js~DecompositionRuleSet.html">DecompositionRuleSet</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/replacer/replacer.js~AutoReplacer.html">AutoReplacer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cengines/replacer/replacer.js~InstructionFilter.html">InstructionFilter</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#libs">libs</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-arrayEqual">arrayEqual</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-arrayFromRange">arrayFromRange</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-complexVectorDot">complexVectorDot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-expmod">expmod</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-intersection">intersection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isComplex">isComplex</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isNumeric">isNumeric</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-len">len</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-narray">narray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-productLoop">productLoop</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-productLoop3">productLoop3</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-randomSample">randomSample</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setDifference">setDifference</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setEqual">setEqual</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setFromRange">setFromRange</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setIsSuperSet">setIsSuperSet</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-stringToBitArray">stringToBitArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-symmetricDifference">symmetricDifference</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-unionSet">unionSet</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ObjectCopy">ObjectCopy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-arrayIsTuple">arrayIsTuple</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-classHierachy">classHierachy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-genString">genString</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-instanceOf">instanceOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isKindclassOf">isKindclassOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isSubclassOf">isSubclassOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-markTuple">markTuple</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-matrixDot">matrixDot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-matrixGetRow">matrixGetRow</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-matrixRangeAssign">matrixRangeAssign</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-matrixRangeIndicesAssign">matrixRangeIndicesAssign</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-tuple">tuple</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-zeros">zeros</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#libs-math">libs/math</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/libs/math/gates.js~AddConstant.html">AddConstant</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/libs/math/gates.js~AddConstantModN.html">AddConstantModN</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/libs/math/gates.js~MultiplyByConstantModN.html">MultiplyByConstantModN</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-add_constant">add_constant</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-add_constant_modN">add_constant_modN</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-mul_by_constant_modN">mul_by_constant_modN</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SubConstant">SubConstant</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SubConstantModN">SubConstantModN</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#meta">meta</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/compute.js~ComputeEngine.html">ComputeEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/compute.js~UncomputeEngine.html">UncomputeEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/control.js~ControlEngine.html">ControlEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/dagger.js~DaggerEngine.html">DaggerEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~LastEngineError.html">LastEngineError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~NoGateDecompositionError.html">NoGateDecompositionError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~NotMergeable.html">NotMergeable</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~NotYetMeasuredError.html">NotYetMeasuredError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/error.js~QubitManagementError.html">QubitManagementError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/loop.js~LoopEngine.html">LoopEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/loop.js~LoopTag.html">LoopTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/tag.js~ComputeTag.html">ComputeTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/tag.js~DirtyQubitTag.html">DirtyQubitTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/tag.js~LogicalQubitIDTag.html">LogicalQubitIDTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meta/tag.js~UncomputeTag.html">UncomputeTag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Compute">Compute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CustomUncompute">CustomUncompute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Uncompute">Uncompute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Control">Control</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Dagger">Dagger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Loop">Loop</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dropEngineAfter">dropEngineAfter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-insertEngine">insertEngine</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ops">ops</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~BasicGate.html">BasicGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~BasicMathGate.html">BasicMathGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~BasicPhaseGate.html">BasicPhaseGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~BasicRotationGate.html">BasicRotationGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~ClassicalInstructionGate.html">ClassicalInstructionGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~FastForwardingGate.html">FastForwardingGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/basics.js~SelfInverseGate.html">SelfInverseGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/command.js~Command.html">Command</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~AllocateDirtyQubitGate.html">AllocateDirtyQubitGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~AllocateQubitGate.html">AllocateQubitGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~BarrierGate.html">BarrierGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~DeallocateQubitGate.html">DeallocateQubitGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~EntangleGate.html">EntangleGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~FlushGate.html">FlushGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~HGate.html">HGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~MeasureGate.html">MeasureGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~Ph.html">Ph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~R.html">R</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~Rx.html">Rx</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~Ry.html">Ry</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~Rz.html">Rz</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~SGate.html">SGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~SqrtSwapGate.html">SqrtSwapGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~SqrtXGate.html">SqrtXGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~SwapGate.html">SwapGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~TGate.html">TGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~XGate.html">XGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~YGate.html">YGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/gates.js~ZGate.html">ZGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/metagates.js~ControlledGate.html">ControlledGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/metagates.js~DaggeredGate.html">DaggeredGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/metagates.js~Tensor.html">Tensor</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/qftgate.js~QFTGate.html">QFTGate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/qubitoperator.js~QubitOperator.html">QubitOperator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ops/timeevolution.js~TimeEvolution.html">TimeEvolution</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-add">add</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get">get</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getInverse">getInverse</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-C">C</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-stringToArray">stringToArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CRz">CRz</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Allocate">Allocate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AllocateDirty">AllocateDirty</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Entangle">Entangle</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-H">H</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Measure">Measure</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-NOT">NOT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-S">S</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SqrtSwap">SqrtSwap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SqrtX">SqrtX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Swap">Swap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-T">T</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-X">X</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Y">Y</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Z">Z</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-obj">obj</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-All">All</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-QFT">QFT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PAULI_OPERATOR_PRODUCTS">PAULI_OPERATOR_PRODUCTS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CNOT">CNOT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CX">CX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CZ">CZ</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Toffoli">Toffoli</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#setups">setups</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-high_level_gates">high_level_gates</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEngineList">getEngineList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ibmqx5_connections">ibmqx5_connections</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#setups-decompositions">setups/decompositions</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_find_parameters">_find_parameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_recognize_arb1qubit">_recognize_arb1qubit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-phase">phase</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_test_matrices">create_test_matrices</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_decompose_barrier">_decompose_barrier</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_recognize_barrier">_recognize_barrier</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_recognize_carb1qubit">_recognize_carb1qubit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_recognize_v">_recognize_v</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_recognize_cnot">_recognize_cnot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_decompose_CnU">_decompose_CnU</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_recognize_CnU">_recognize_CnU</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_recognize_RxNoCtrl">_recognize_RxNoCtrl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_decompose_ry">_decompose_ry</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-_recognize_RyNoCtrl">_recognize_RyNoCtrl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-rule_commuting_terms">rule_commuting_terms</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-rule_individual_terms">rule_individual_terms</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#types">types</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/types/qubit.js~BasicQubit.html">BasicQubit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/types/qubit.js~Qubit.html">Qubit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Qureg">Qureg</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/ops/qubitoperator.spec.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/*
 * Copyright (c) 2018 Isaac Phoenix (tearsofphoenix@icloud.com).
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import {expect} from &apos;chai&apos;
import math from &apos;mathjs&apos;
import QubitOperator, {PAULI_OPERATOR_PRODUCTS} from &apos;./qubitoperator&apos;
import {tuple} from &apos;../libs/util&apos;

const mc = math.complex

describe(&apos;qubit operator test&apos;, () =&gt; {
  it(&apos;should test pauli operator product unchanged&apos;, () =&gt; {
    const correct = {
      [[&apos;I&apos;, &apos;I&apos;]]: [1.0, &apos;I&apos;],
      [[&apos;I&apos;, &apos;X&apos;]]: [1.0, &apos;X&apos;],
      [[&apos;X&apos;, &apos;I&apos;]]: [1.0, &apos;X&apos;],
      [[&apos;I&apos;, &apos;Y&apos;]]: [1.0, &apos;Y&apos;],
      [[&apos;Y&apos;, &apos;I&apos;]]: [1.0, &apos;Y&apos;],
      [[&apos;I&apos;, &apos;Z&apos;]]: [1.0, &apos;Z&apos;],
      [[&apos;Z&apos;, &apos;I&apos;]]: [1.0, &apos;Z&apos;],
      [[&apos;X&apos;, &apos;X&apos;]]: [1.0, &apos;I&apos;],
      [[&apos;Y&apos;, &apos;Y&apos;]]: [1.0, &apos;I&apos;],
      [[&apos;Z&apos;, &apos;Z&apos;]]: [1.0, &apos;I&apos;],
      [[&apos;X&apos;, &apos;Y&apos;]]: [mc(0, 1), &apos;Z&apos;],
      [[&apos;X&apos;, &apos;Z&apos;]]: [mc(0, -1), &apos;Y&apos;],
      [[&apos;Y&apos;, &apos;X&apos;]]: [mc(0, -1), &apos;Z&apos;],
      [[&apos;Y&apos;, &apos;Z&apos;]]: [mc(0, 1), &apos;X&apos;],
      [[&apos;Z&apos;, &apos;X&apos;]]: [mc(0, 1), &apos;Y&apos;],
      [[&apos;Z&apos;, &apos;Y&apos;]]: [mc(0, -1), &apos;X&apos;]
    }

    Object.keys(correct).forEach((key) =&gt; {
      const value = correct[key]
      const v2 = PAULI_OPERATOR_PRODUCTS[key]
      expect(value).to.deep.equal(v2)
    })
  });

  it(&apos;should test init defaults&apos;, () =&gt; {
    const op = new QubitOperator()
    expect(Object.keys(op.terms).length).to.equal(0)
  });

  it(&apos;should test_init_tuple&apos;, () =&gt; {
    const coefficients = [0.5, mc(0, 0.6), 2.303, mc(0, -1)]
    coefficients.forEach((coefficient) =&gt; {
      const loc_op = tuple([0, &apos;X&apos;], [5, &apos;Y&apos;], [6, &apos;Z&apos;])
      const qubit_op = new QubitOperator(loc_op, coefficient)
      expect(Object.keys(qubit_op.terms).length).to.equal(1)
      expect(math.equal(qubit_op.terms[loc_op], coefficient)).to.equal(true)
    })
  });

  it(&apos;should test_init_str&apos;, () =&gt; {
    const qubit_op = new QubitOperator(&apos;X0 Y5 Z12&apos;, -1.0)
    const correct = tuple([0, &apos;X&apos;], [5, &apos;Y&apos;], [12, &apos;Z&apos;])
    const value = qubit_op.terms[correct]
    expect(typeof value !== &apos;undefined&apos;).to.equal(true)
    expect(value).to.equal(-1.0)
  });

  it(&apos;should test_init_str_identity&apos;, () =&gt; {
    const qubit_op = new QubitOperator(&apos;&apos;, 2.0)
    expect(Object.keys(qubit_op.terms).length).to.equal(1)
    const value = qubit_op.terms[[]]
    expect(typeof value !== &apos;undefined&apos;).to.equal(true)
    expect(value).to.equal(2.0)
  });

  it(&apos;should test_init_bad_coefficient&apos;, () =&gt; {
    expect(() =&gt; new QubitOperator(&apos;X0&apos;, &apos;0.5&apos;)).to.throw()
  });

  it(&apos;should test_init_bad_action&apos;, () =&gt; {
    expect(() =&gt; new QubitOperator(&apos;Q0&apos;)).to.throw()
  });

  it(&apos;should test_init_bad_action_in_tuple&apos;, () =&gt; {
    expect(() =&gt; new QubitOperator(tuple([1, &apos;Q&apos;]))).to.throw()
  });

  it(&apos;should test_init_bad_qubit_num_in_tuple&apos;, () =&gt; {
    expect(() =&gt; new QubitOperator(tuple([&apos;1&apos;, &apos;X&apos;]))).to.throw()
  });

  it(&apos;should test_init_bad_tuple&apos;, () =&gt; {
    expect(() =&gt; new QubitOperator(tuple([0, 1, &apos;X&apos;]))).to.throw()
  });

  it(&apos;should test_init_bad_str&apos;, () =&gt; {
    expect(() =&gt; new QubitOperator(&apos;X&apos;)).to.throw()
  });

  it(&apos;should test_init_bad_qubit_num&apos;, () =&gt; {
    expect(() =&gt; new QubitOperator(&apos;X-1&apos;)).to.throw()
  });

  it(&apos;should test_isclose_abs_tol&apos;, () =&gt; {
    let a = new QubitOperator(&apos;X0&apos;, -1.0)
    let b = new QubitOperator(&apos;X0&apos;, -1.05)
    let c = new QubitOperator(&apos;X0&apos;, -1.11)

    expect(a.isClose(b, 1e-14, 0.1)).to.equal(true)
    expect(a.isClose(c, 1e-14, 0.1)).to.equal(false)
    a = new QubitOperator(&apos;X0&apos;, mc(0, -1.0))
    b = new QubitOperator(&apos;X0&apos;, mc(0, -1.05))
    c = new QubitOperator(&apos;X0&apos;, mc(0, -1.11))
    expect(a.isClose(b, 1e-14, 0.1)).to.equal(true)
    expect(a.isClose(c, 1e-14, 0.1)).to.equal(false)
  });

  it(&apos;should test compress&apos;, () =&gt; {
    const Complex = mc().constructor
    let a = new QubitOperator(&apos;X0&apos;, 0.9e-12)
    expect(Object.keys(a.terms).length).to.equal(1)
    a.compress()
    expect(Object.keys(a.terms).length).to.equal(0)
    a = new QubitOperator(&apos;X0&apos;, mc(1.0, 1))
    a.compress(0.5)
    expect(Object.keys(a.terms).length).to.equal(1)
    Object.keys(a.terms).forEach((key) =&gt; {
      const v = a.terms[key]
      expect(math.equal(v, mc(1.0, 1))).to.equal(true)
    })

    a = new QubitOperator(&apos;X0&apos;, mc(1.1, 1))
    a.compress(1.0)

    expect(Object.keys(a.terms).length).to.equal(1)
    Object.keys(a.terms).forEach((key) =&gt; {
      const v = a.terms[key]
      expect(math.equal(v, 1.1)).to.equal(true)
    })

    a = new QubitOperator(&apos;X0&apos;, mc(1.1, 1)).add(new QubitOperator(&apos;X1&apos;, mc(0, 1.e-6)))
    a.compress()
    expect(Object.keys(a.terms).length).to.equal(2)
    Object.keys(a.terms).forEach((key) =&gt; {
      const v = a.terms[key]
      expect(v instanceof Complex).to.equal(true)
    })

    a.compress(1.e-5)
    expect(Object.keys(a.terms).length).to.equal(1)
    Object.keys(a.terms).forEach((key) =&gt; {
      const v = a.terms[key]
      expect(v instanceof Complex).to.equal(true)
    })

    a.compress(1.0)
    expect(Object.keys(a.terms).length).to.equal(1)
    Object.keys(a.terms).forEach((key) =&gt; {
      const v = a.terms[key]
      expect(typeof v === &apos;number&apos;).to.equal(true)
    })
  });

  it(&apos;should test_isclose_rel_tol&apos;, () =&gt; {
    const a = new QubitOperator(&apos;X0&apos;, 1)
    const b = new QubitOperator(&apos;X0&apos;, 2)
    expect(a.isClose(b, 2.5, 0.1)).to.equal(true)
    // Test symmetry
    expect(a.isClose(b, 1, 0.1)).to.equal(true)
    expect(b.isClose(a, 1, 0.1)).to.equal(true)
  });

  it(&apos;should test_isclose_zero_terms&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;Y&apos;], [0, &apos;X&apos;]), mc(0, -1)).mul(0)
    expect(op.isClose(new QubitOperator([], 0.0), 1e-12, 1e-12)).to.equal(true)
    expect(new QubitOperator([], 0.0).isClose(op, 1e-12, 1e-12)).to.equal(true)
  });

  it(&apos;should test_isclose_different_terms&apos;, () =&gt; {
    const a = new QubitOperator(tuple([1, &apos;Y&apos;]), mc(0, -0.1))
    const b = new QubitOperator(tuple([1, &apos;X&apos;]), mc(0, -0.1))
    expect(a.isClose(b, 1e-12, 0.2)).to.equal(true)
    expect(a.isClose(b, 1e-12, 0.05)).to.equal(false)
    expect(b.isClose(a, 1e-12, 0.2)).to.equal(true)
    expect(b.isClose(a, 1e-12, 0.05)).to.equal(false)
  });

  it(&apos;should test_isclose_different_num_terms&apos;, () =&gt; {
    const a = new QubitOperator(tuple([1, &apos;Y&apos;]), mc(0, -0.1))
    a.iadd(new QubitOperator(tuple([2, &apos;Y&apos;]), mc(0, -0.1)))
    const b = new QubitOperator(tuple([1, &apos;X&apos;]), mc(0, -0.1))

    expect(a.isClose(b, 1e-12, 0.05)).to.equal(false)
    expect(b.isClose(a, 1e-12, 0.05)).to.equal(false)
  });

  it(&apos;should test_imul_inplace&apos;, () =&gt; {
    const qubit_op = new QubitOperator(&apos;X1&apos;)
    const prev_id = qubit_op
    qubit_op.imul(3)
    expect(qubit_op === prev_id).to.equal(true)
  });

  it(&apos;should test_imul_scalar&apos;, () =&gt; {
    const data = [0.5, mc(0, 0.6), 2.303, mc(0, -1)]
    data.forEach((multiplier) =&gt; {
      const loc_op = tuple([1, &apos;X&apos;], [2, &apos;Y&apos;])
      const qubit_op = new QubitOperator(loc_op)
      qubit_op.imul(multiplier)
      const v = qubit_op.terms[loc_op]
      expect(math.equal(v, multiplier)).to.equal(true)
    })
  });

  it(&apos;should test_imul_qubit_op&apos;, () =&gt; {
    const op1 = new QubitOperator(tuple([0, &apos;Y&apos;], [3, &apos;X&apos;], [8, &apos;Z&apos;], [11, &apos;X&apos;]), mc(0, 3.0))
    const op2 = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    op1.imul(op2)
    const correct_coefficient = math.multiply(math.multiply(mc(0, 1.0), mc(0, 3.0)), 0.5)
    const correct_term = tuple([0, &apos;Y&apos;], [1, &apos;X&apos;], [3, &apos;Z&apos;], [11, &apos;X&apos;])

    expect(Object.keys(op1.terms).length).to.equal(1)
    const v = op1.terms[correct_term]
    expect(math.equal(v, correct_coefficient)).to.equal(true)
  });

  it(&apos;should test_imul_qubit_op_2&apos;, () =&gt; {
    const op3 = new QubitOperator(tuple([1, &apos;Y&apos;], [0, &apos;X&apos;]), mc(0, -1))
    const op4 = new QubitOperator(tuple([1, &apos;Y&apos;], [0, &apos;X&apos;], [2, &apos;Z&apos;]), -1.5)

    op3.imul(op4)
    op4.imul(op3)
    const v = op3.terms[[2, &apos;Z&apos;]]
    expect(!!v).to.equal(true)
    expect(math.equal(v, mc(0, 1.5))).to.equal(true)
  });

  it(&apos;should test_imul_bidir&apos;, () =&gt; {
    const op_a = new QubitOperator(tuple([1, &apos;Y&apos;], [0, &apos;X&apos;]), mc(0, -1))
    const op_b = new QubitOperator(tuple([1, &apos;Y&apos;], [0, &apos;X&apos;], [2, &apos;Z&apos;]), -1.5)
    op_a.imul(op_b)
    op_b.imul(op_a)

    const v = op_a.terms[[2, &apos;Z&apos;]]
    expect(math.equal(v, mc(0, 1.5))).to.equal(true)
    const c = op_b.terms[[[0, &apos;X&apos;], [1, &apos;Y&apos;]]]
    expect(math.equal(c, mc(0, -2.25))).to.equal(true)
  });

  it(&apos;should test_imul_bad_multiplier&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;Y&apos;], [0, &apos;X&apos;]), mc(0, -1))
    expect(() =&gt; op.imul(&apos;1&apos;)).to.throw()
  });

  it(&apos;should test_mul_by_scalarzero&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;Y&apos;], [0, &apos;X&apos;]), mc(0, -1)).mul(0)
    const key = [[0, &apos;X&apos;], [1, &apos;Y&apos;]]
    const v = op.terms[key]
    expect(math.equal(v, mc(0, 0))).to.equal(true)
  });

  it(&apos;should test_mul_bad_multiplier&apos;, () =&gt; {
    let op = new QubitOperator(tuple([1, &apos;Y&apos;], [0, &apos;X&apos;]), mc(0, -1))
    expect(() =&gt; op = op.mul(&apos;0.5&apos;)).to.throw()
  });

  it(&apos;should test_mul_out_of_place&apos;, () =&gt; {
    const op1 = new QubitOperator(tuple([0, &apos;Y&apos;], [3, &apos;X&apos;], [8, &apos;Z&apos;], [11, &apos;X&apos;]), mc(0, 3.0))
    const op2 = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    const op3 = op1.mul(op2)
    const correct_coefficient = math.multiply(math.multiply(mc(0, 1), mc(0, 3)), 0.5)
    const correct_term = tuple([0, &apos;Y&apos;], [1, &apos;X&apos;], [3, &apos;Z&apos;], [11, &apos;X&apos;])

    expect(op1.isClose(new QubitOperator(tuple([0, &apos;Y&apos;], [3, &apos;X&apos;], [8, &apos;Z&apos;], [11, &apos;X&apos;]), mc(0, 3.0)))).to.equal(true)
    expect(op2.isClose(new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5))).to.equal(true)
    expect(op3.isClose(new QubitOperator(correct_term, correct_coefficient))).to.equal(true)
  });

  it(&apos;should test_mul_npfloat64&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;]), 0.5)
    const res = op.mul(0.5)
    expect(res.isClose(new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;]), 0.5 * 0.5))).to.equal(true)
  });

  it(&apos;should test_mul_multiple_terms&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    op.iadd(new QubitOperator(tuple([1, &apos;Z&apos;], [3, &apos;X&apos;], [8, &apos;Z&apos;]), 1.2))
    op.iadd(new QubitOperator(tuple([1, &apos;Z&apos;], [3, &apos;Y&apos;], [9, &apos;Z&apos;]), mc(0, 1.4)))
    const res = op.mul(op)
    const correct = new QubitOperator([], math.add((0.5 ** 2) + (1.2 ** 2), math.pow(mc(0, 1.4), 2)))
    correct.iadd(new QubitOperator(tuple([1, &apos;Y&apos;], [3, &apos;Z&apos;]), math.multiply(math.multiply(mc(0, 2), mc(0, 1)), 0.6)))
    expect(res.isClose(correct)).to.equal(true)
  });

  it(&apos;should test_truediv_and_div&apos;, () =&gt; {
    const divisors = [0.5, mc(0, 0.6), 2.303, mc(0, -1), 2]
    divisors.forEach((divisor) =&gt; {
      const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
      const op2 = op.copy()
      const original = op.copy()
      const res = op.div(divisor)
      const correct = op.mul(math.divide(1.0, divisor))

      expect(res.isClose(correct)).to.equal(true)
      // Test if done out of place
      expect(op.isClose(original)).to.equal(true)
      expect(op2.isClose(original)).to.equal(true)
    })
  });

  it(&apos;should test_truediv_bad_divisor&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    expect(() =&gt; op.div(&apos;0.5&apos;)).to.throw()
  });

  it(&apos;should test_itruediv_and_idiv&apos;, () =&gt; {
    const divisors = [0.5, mc(0, 0.6), 2.303, mc(0, -1), 2]
    divisors.forEach((divisor) =&gt; {
      const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
      const op2 = op.copy()
      const original = op.copy()
      const correct = op.mul(math.divide(1.0, divisor))

      op.idiv(divisor)
      op2.idiv(divisor)

      expect(op.isClose(correct)).to.equal(true)
      expect(op2.isClose(correct)).to.equal(true)

      // Test if done out of place
      expect(op.isClose(original)).to.equal(false)
      expect(op2.isClose(original)).to.equal(false)
    })
  });

  it(&apos;should test_itruediv_bad_divisor&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    expect(() =&gt; op.idiv(&apos;0.5&apos;)).to.throw()
  });

  it(&apos;should test_iadd_cancellation&apos;, () =&gt; {
    const term_a = tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const term_b = tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const a = new QubitOperator(term_a, 1.0)
    a.iadd(new QubitOperator(term_b, -1.0))
    expect(Object.keys(a.terms).length).to.equal(0)
  });

  it(&apos;should test_iadd_different_term&apos;, () =&gt; {
    const term_a = tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const term_b = tuple([1, &apos;Z&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const a = new QubitOperator(term_a, 1.0)
    a.iadd(new QubitOperator(term_b, 0.5))
    expect(Object.keys(a.terms).length).to.equal(2)
    expect(a.terms[term_a]).to.be.closeTo(1.0, 1e-12)
    expect(a.terms[term_b]).to.be.closeTo(0.5, 1e-12)

    a.iadd(new QubitOperator(term_b, 0.5))

    expect(Object.keys(a.terms).length).to.equal(2)
    expect(a.terms[term_a]).to.be.closeTo(1.0, 1e-12)
    expect(a.terms[term_b]).to.be.closeTo(1.0, 1e-12)
  });

  it(&apos;should test_iadd_bad_addend&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    expect(() =&gt; op.iadd(&apos;0.5&apos;)).to.throw()
  });

  it(&apos;should test add&apos;, () =&gt; {
    const term_a = tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const term_b = tuple([1, &apos;Z&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const a = new QubitOperator(term_a, 1.0)
    const b = new QubitOperator(term_b, 0.5)
    const res = a.add(b).add(b)
    expect(Object.keys(res.terms).length).to.equal(2)
    expect(res.terms[term_a]).to.be.closeTo(1.0, 1e-12)
    expect(res.terms[term_b]).to.be.closeTo(1.0, 1e-12)
    // Test out of place
    expect(a.isClose(new QubitOperator(term_a, 1.0))).to.equal(true)
    expect(b.isClose(new QubitOperator(term_b, 0.5))).to.equal(true)
  });

  it(&apos;should test_add_bad_addend&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    expect(() =&gt; op.add(&apos;0.5&apos;)).to.throw()
  });

  it(&apos;should test sub&apos;, () =&gt; {
    const term_a = tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const term_b = tuple([1, &apos;Z&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const a = new QubitOperator(term_a, 1.0)
    const b = new QubitOperator(term_b, 0.5)
    const res = a.sub(b)
    expect(Object.keys(res.terms).length).to.equal(2)
    expect(res.terms[term_a]).to.be.closeTo(1.0, 1e-12)
    expect(res.terms[term_b]).to.be.closeTo(-0.5, 1e-12)

    const res2 = b.sub(a)
    expect(Object.keys(res2.terms).length).to.equal(2)
    expect(res2.terms[term_a]).to.be.closeTo(-1.0, 1e-12)
    expect(res2.terms[term_b]).to.be.closeTo(0.5, 1e-12)
  });

  it(&apos;should test_sub_bad_addend&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    expect(() =&gt; op.sub(&apos;0.5&apos;)).to.throw()
  });

  it(&apos;should test_isub_different_term&apos;, () =&gt; {
    const term_a = tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const term_b = tuple([1, &apos;Z&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;])
    const a = new QubitOperator(term_a, 1.0)
    a.isub(new QubitOperator(term_b, 0.5))
    expect(Object.keys(a.terms).length).to.equal(2)
    expect(a.terms[term_a]).to.be.closeTo(1.0, 1e-12)
    expect(a.terms[term_b]).to.be.closeTo(-0.5, 1e-12)

    a.isub(new QubitOperator(term_b, 0.5))
    expect(Object.keys(a.terms).length).to.equal(2)
    expect(a.terms[term_a]).to.be.closeTo(1.0, 1e-12)
    expect(a.terms[term_b]).to.be.closeTo(-1, 1e-12)
  });

  it(&apos;should test_isub_bad_addend&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    expect(() =&gt; op.isub(&apos;0.5&apos;)).to.throw()
  });

  it(&apos;should test_neg&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    op.negative()
    // out of place
    expect(op.isClose(new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5))).to.equal(true)
    const correct = op.mul(-1)
    expect(correct.isClose(op.negative())).to.equal(true)
  });

  it(&apos;should test to string&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    expect(op.toString()).to.equal(&apos;0.5 X1 Y3 Z8&apos;)
    const op2 = new QubitOperator([], 2)
    expect(op2.toString()).to.equal(&apos;2 I&apos;)
  });

  it(&apos;should test_str_empty&apos;, () =&gt; {
    const op = new QubitOperator()
    expect(op.toString()).to.equal(&apos;0&apos;)
  });

  it(&apos;should test_str_multiple_terms&apos;, () =&gt; {
    const op = new QubitOperator(tuple([1, &apos;X&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.5)
    op.iadd(new QubitOperator(tuple([1, &apos;Y&apos;], [3, &apos;Y&apos;], [8, &apos;Z&apos;]), 0.6))
    expect(op.toString() === &apos;0.5 X1 Y3 Z8 +\n0.6 Y1 Y3 Z8&apos; || op.toString() === &apos;0.6 Y1 Y3 Z8 +\n0.5 X1 Y3 Z8&apos;).to.equal(true)
    const op2 = new QubitOperator([], 2)
    expect(op2.toString()).to.equal(&apos;2 I&apos;)
  });
})
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
